{"version":3,"file":"index.js","sources":["index.js"],"sourcesContent":["'use strict';\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar _extends = Object.assign || function (target) { for (var i = 1; i < arguments.length; i++) { var source = arguments[i]; for (var key in source) { if (Object.prototype.hasOwnProperty.call(source, key)) { target[key] = source[key]; } } } return target; };\n\nvar _createClass = function () { function defineProperties(target, props) { for (var i = 0; i < props.length; i++) { var descriptor = props[i]; descriptor.enumerable = descriptor.enumerable || false; descriptor.configurable = true; if (\"value\" in descriptor) descriptor.writable = true; Object.defineProperty(target, descriptor.key, descriptor); } } return function (Constructor, protoProps, staticProps) { if (protoProps) defineProperties(Constructor.prototype, protoProps); if (staticProps) defineProperties(Constructor, staticProps); return Constructor; }; }();\n\nvar _react = require('react');\n\nfunction _objectWithoutProperties(obj, keys) { var target = {}; for (var i in obj) { if (keys.indexOf(i) >= 0) continue; if (!Object.prototype.hasOwnProperty.call(obj, i)) continue; target[i] = obj[i]; } return target; }\n\nfunction _classCallCheck(instance, Constructor) { if (!(instance instanceof Constructor)) { throw new TypeError(\"Cannot call a class as a function\"); } }\n\nfunction _possibleConstructorReturn(self, call) { if (!self) { throw new ReferenceError(\"this hasn't been initialised - super() hasn't been called\"); } return call && (typeof call === \"object\" || typeof call === \"function\") ? call : self; }\n\nfunction _inherits(subClass, superClass) { if (typeof superClass !== \"function\" && superClass !== null) { throw new TypeError(\"Super expression must either be null or a function, not \" + typeof superClass); } subClass.prototype = Object.create(superClass && superClass.prototype, { constructor: { value: subClass, enumerable: false, writable: true, configurable: true } }); if (superClass) Object.setPrototypeOf ? Object.setPrototypeOf(subClass, superClass) : subClass.__proto__ = superClass; }\n\nvar NanoClamp = function (_Component) {\n  _inherits(NanoClamp, _Component);\n\n  function NanoClamp(props) {\n    _classCallCheck(this, NanoClamp);\n\n    var _this = _possibleConstructorReturn(this, (NanoClamp.__proto__ || Object.getPrototypeOf(NanoClamp)).call(this, props));\n\n    _this.state = {\n      noClamp: false,\n      text: '.'\n    };\n\n    _this.element = null;\n    _this.original = props.text;\n    _this.lineHeight = 0;\n    _this.start = 0;\n    _this.middle = 0;\n    _this.end = 0;\n    _this.debounced = _this.debounce(_this.action);\n    return _this;\n  }\n\n  _createClass(NanoClamp, [{\n    key: 'componentDidMount',\n    value: function componentDidMount() {\n      window.addEventListener('resize', this.debounced);\n      if (this.props.text) {\n        this.lineHeight = this.element.clientHeight + 1;\n        this.clampLines();\n      }\n    }\n  }, {\n    key: 'componentWillUnmount',\n    value: function componentWillUnmount() {\n      window.removeEventListener('resize', this.debounced);\n    }\n  }, {\n    key: 'debounce',\n    value: function debounce(func) {\n      var _this2 = this;\n\n      var timeout = void 0;\n      var later = function later() {\n        timeout = null;\n        func.apply(_this2);\n      };\n\n      return function () {\n        var callNow = !timeout;\n        clearTimeout(timeout);\n        timeout = setTimeout(later, _this2.props.debounce);\n        if (callNow) func.apply(_this2);\n      };\n    }\n  }, {\n    key: 'action',\n    value: function action() {\n      this.setState({ noClamp: false }, this.clampLines);\n    }\n  }, {\n    key: 'clampLines',\n    value: function clampLines() {\n      var _this3 = this;\n\n      var _props = this.props,\n          ellipsis = _props.ellipsis,\n          lines = _props.lines;\n\n      var maxHeight = this.lineHeight * lines + 1;\n      var ellipsisLength = ellipsis === NanoClamp.defaultProps.ellipsis ? 5 : ellipsis.length * 1.2;\n\n      this.start = 0;\n      this.middle = 0;\n      this.end = this.original.length;\n\n      while (this.start <= this.end) {\n        this.middle = Math.floor((this.start + this.end) / 2);\n        this.element.innerText = this.original.slice(0, this.middle);\n\n        if (this.middle === this.original.length) {\n          this.setState({ text: this.original, noClamp: true });\n          return;\n        }\n\n        this.moveMarkers(maxHeight);\n      }\n      var text = this.original.slice(0, Math.max(this.middle - ellipsisLength, 0)).trim() + ellipsis;\n\n      this.setState({ text: text }, function () {\n        _this3.element.innerText = _this3.state.text;\n      });\n    }\n  }, {\n    key: 'moveMarkers',\n    value: function moveMarkers(maxHeight) {\n      if (this.element.clientHeight <= maxHeight) this.start = this.middle + 1;else this.end = this.middle - 1;\n    }\n  }, {\n    key: 'render',\n    value: function render() {\n      var _this4 = this;\n\n      var text = this.state.text;\n\n      var _props2 = this.props,\n          is = _props2.is,\n          propText = _props2.text,\n          lines = _props2.lines,\n          debounce = _props2.debounce,\n          ellipsis = _props2.ellipsis,\n          props = _objectWithoutProperties(_props2, ['is', 'text', 'lines', 'debounce', 'ellipsis']);\n\n      var clampProps = _extends({ ref: function ref(node) {\n          return _this4.element = node;\n        } }, props);\n      return propText ? (0, _react.createElement)(is, clampProps, text) : null;\n    }\n  }]);\n\n  return NanoClamp;\n}(_react.Component);\n\nNanoClamp.defaultProps = {\n  is: 'div',\n  lines: 3,\n  ellipsis: 'â€¦',\n  debounce: 300\n};\n\nexports.default = NanoClamp;"],"names":["Object","defineProperty","exports","value","_extends","assign","target","i","arguments","length","source","key","prototype","hasOwnProperty","call","_createClass","defineProperties","props","descriptor","enumerable","configurable","writable","Constructor","protoProps","staticProps","_react","require","NanoClamp","_Component","instance","TypeError","_classCallCheck","this","_this","self","ReferenceError","_possibleConstructorReturn","__proto__","getPrototypeOf","state","noClamp","text","element","original","lineHeight","start","middle","end","debounced","debounce","action","subClass","superClass","create","constructor","setPrototypeOf","_inherits","Component","window","addEventListener","clientHeight","clampLines","removeEventListener","func","_this2","timeout","later","apply","callNow","clearTimeout","setTimeout","setState","_this3","_props","ellipsis","maxHeight","lines","ellipsisLength","defaultProps","Math","floor","innerText","slice","moveMarkers","max","trim","_this4","_props2","is","propText","obj","keys","indexOf","_objectWithoutProperties","clampProps","ref","node","createElement","default"],"mappings":"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"}